    r = sqrt(wc_x * wc_x + wc_y * wc_y) - Calculates the horizontal distance of the end effector from the base of the robot.

    s = wc_z - d1 - Calculates the vertical distance of the end effector from the base of the robot, adjusted for the height of the first joint.

    theta1 = atan2(wc_y, wc_x) - Calculates the angle between the x-axis and the projection of the end effector position onto the xy-plane.

    theta3 = acos((r * r + s * s - l2 * l2 - l3 * l3) / (2 * l2 * l3)) - Calculates the angle between the second and third links of the robot using the law of cosines.

    theta2 = atan2(s, r) - atan2(l3 * sin(theta3), l2 + l3 * cos(theta3)) - Calculates the angle between the first and second links of the robot using trigonometry.

    theta4 = a4 - a2 - theta2 - theta3 - Calculates the twist angle of the fourth joint of the robot.